<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <title>MarkerManager Documentation: Examples</title>
    <link rel="stylesheet" type="text/css" href="http://code.google.com/css/dev_docs.css" />
  </head>
  <body>
<h1><a name="Marker_Manager_Examples" id="Marker_Manager_Examples"></a>Marker Manager Examples</h1>

<p>To use a marker manager, create a <code>MarkerManager</code> object. In the simplest case, just pass a map to it.</p>
<pre class="prettyprint"><span class="kwd">var</span><span class="pln"> map </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">GMap2</span><span class="pun">(</span><span class="pln">document</span><span class="pun">.</span><span class="pln">getElementById</span><span class="pun">(</span><span class="str">"map"</span><span class="pun">));</span><span class="pln"><br></span><span class="kwd">var</span><span class="pln"> mgr </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MarkerManager</span><span class="pun">(</span><span class="pln">map</span><span class="pun">);</span></pre>

<p>You may also specify a number of options to fine-tune the marker manager's performance. These options are passed via a <code>MarkerManagerOptions</code> object, which contains the following fields:</p>

<ul>
  <li><code>maxZoom</code>: specifies the maximum zoom level monitored by this marker manager. The default value is the highest zoom level supported by Google maps.</li>
  <li><code>borderPadding</code>: specifies the extra padding, in pixels, monitored by the manager outside the current viewport. This allows for markers just out of sight to be displayed on the map, improving panning over small ranges. The default value is 100.</li>
  <li><code>trackMarkers</code>: specifies whether movement of movements of markers should be tracked by the marker manager. If you wish to have managed markers that change their positions through the <code>setPoint()</code> method, set this value to <code>true</code>. By default, this flag is set to <code>false</code>. Note that if you move markers with this value set to <code>false</code>, they will appear in both the original location and the new location(s).</li>

</ul>
<p>
The <code>MarkerManagerOptions</code> object is an object literal, so you simply declare the object without a constructor:
</p><pre class="prettyprint"><span class="kwd">var</span><span class="pln"> map </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">GMap2</span><span class="pun">(</span><span class="pln">document</span><span class="pun">.</span><span class="pln">getElementById</span><span class="pun">(</span><span class="str">"map"</span><span class="pun">));</span><span class="pln"><br></span><span class="kwd">var</span><span class="pln"> mgrOptions </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> borderPadding</span><span class="pun">:</span><span class="pln"> </span><span class="lit">50</span><span class="pun">,</span><span class="pln"> maxZoom</span><span class="pun">:</span><span class="pln"> </span><span class="lit">15</span><span class="pun">,</span><span class="pln"> trackMarkers</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pln"> </span><span class="pun">};</span><span class="pln"><br></span><span class="kwd">var</span><span class="pln"> mgr </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MarkerManager</span><span class="pun">(</span><span class="pln">map</span><span class="pun">,</span><span class="pln"> mgrOptions</span><span class="pun">);</span></pre>


<p>Once you create a manager, you will want to add markers to it. <code>MarkerManager</code> supports adding single markers one at a time using the <code>addMarker()</code> method or a collection passed as an array using the <code>addMarkers()</code> method. Single markers added using <code>addMarker()</code> will appear immediately on the map provided that they fall within the current view and specified zoom level constraints.</p>

<p>Adding markers collectively using <code>addMarkers()</code> is recommended as it is more efficient. Markers added using the <code>addMarkers()</code> method will not appear on the map until you explicitly call the <code>MarkerManager</code>'s <code>refresh()</code> method, which adds all markers within the current viewport and border padding region to the map. After this initial display, <code>MarkerManager</code> takes care of all visual updates by monitoring the map's "moveend" events.</p>

<h2><a name="Marker_Manager_Weather" id="Marker_Manager_Weather"></a>Zoom Level Example: Weather Map</h2>

<p>The following example creates a mock weather map for Europe. At zoom level 3, 20 randomly distributed weather icons are displayed. At level 6, when all 200 cities with population over 300,000 are easily distinguished, an additional 200 markers are shown. Finally, at level 8, 1000 markers are shown. (Note: to simplify the example, markers will be added at random locations.)</p>

<pre class="prettyprint"><span class="kwd">function</span><span class="pln"> setupMap</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="typ">GBrowserIsCompatible</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; map </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">GMap2</span><span class="pun">(</span><span class="pln">document</span><span class="pun">.</span><span class="pln">getElementById</span><span class="pun">(</span><span class="str">"map"</span><span class="pun">));</span><span class="pln"><br>&nbsp; &nbsp; map</span><span class="pun">.</span><span class="pln">addControl</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">GLargeMapControl</span><span class="pun">());</span><span class="pln"><br>&nbsp; &nbsp; map</span><span class="pun">.</span><span class="pln">setCenter</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">GLatLng</span><span class="pun">(</span><span class="lit">41</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">98</span><span class="pun">),</span><span class="pln"> </span><span class="lit">4</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; window</span><span class="pun">.</span><span class="pln">setTimeout</span><span class="pun">(</span><span class="pln">setupWeatherMarkers</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br><br></span><span class="kwd">function</span><span class="pln"> getWeatherMarkers</span><span class="pun">(</span><span class="pln">n</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">var</span><span class="pln"> batch </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[];</span><span class="pln"><br>&nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span>&lt;<span class="pln"> n</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; batch</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">GMarker</span><span class="pun">(</span><span class="pln">getRandomPoint</span><span class="pun">(),</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> icon</span><span class="pun">:</span><span class="pln"> getWeatherIcon</span><span class="pun">()</span><span class="pln"> </span><span class="pun">}));</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="kwd">return</span><span class="pln"> batch</span><span class="pun">;</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br><br></span><span class="kwd">function</span><span class="pln"> setupWeatherMarkers</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; mgr </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MarkerManager</span><span class="pun">(</span><span class="pln">map</span><span class="pun">);</span><span class="pln"><br>&nbsp; mgr</span><span class="pun">.</span><span class="pln">addMarkers</span><span class="pun">(</span><span class="pln">getWeatherMarkers</span><span class="pun">(</span><span class="lit">20</span><span class="pun">),</span><span class="pln"> </span><span class="lit">3</span><span class="pun">);</span><span class="pln"><br>&nbsp; mgr</span><span class="pun">.</span><span class="pln">addMarkers</span><span class="pun">(</span><span class="pln">getWeatherMarkers</span><span class="pun">(</span><span class="lit">200</span><span class="pun">),</span><span class="pln"> </span><span class="lit">6</span><span class="pun">);</span><span class="pln"><br>&nbsp; mgr</span><span class="pun">.</span><span class="pln">addMarkers</span><span class="pun">(</span><span class="pln">getWeatherMarkers</span><span class="pun">(</span><span class="lit">1000</span><span class="pun">),</span><span class="pln"> </span><span class="lit">8</span><span class="pun">);</span><span class="pln"><br>&nbsp; mgr</span><span class="pun">.</span><span class="pln">refresh</span><span class="pun">();</span><span class="pln"><br></span><span class="pun">}</span></pre>

<p><a href="weather_map.html">View example (weather_map.html)</a></p>

<h2><a name="Marker_Manager_Offices" id="Marker_Manager_Offices"></a>Clustering Example: Google Offices</h2>

<p>The marker manager can also perform simple clustering of markers. While it does not do so automatically, you can achieve the desired effect by setting both the minimum and maximum zoom at which a given marker is shown. In this example we create a map of Google offices in North America. At the highest level we show flags of countries in which offices are located. For zoom levels 3 to 7 we show icons over population centers where one or more offices are located. Finally, at levels 8 or higher, we show individual markers for each office.</p>

<pre class="prettyprint"><span class="kwd">var</span><span class="pln"> officeLayer </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln"><br>&nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="str">"zoom"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pun">],</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="str">"places"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"> </span><span class="str">"name"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"US Offices"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"icon"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="str">"us"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"flag-shadow"</span><span class="pun">],</span><span class="pln"> </span><span class="str">"posn"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="lit">40</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">97</span><span class="pun">]</span><span class="pln"> </span><span class="pun">},</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"> </span><span class="str">"name"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"Canadian Offices"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"icon"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="str">"ca"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"flag-shadow"</span><span class="pun">],</span><span class="pln"> </span><span class="str">"posn"</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="lit">58</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">101</span><span class="pun">]</span><span class="pln"> </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">]</span><span class="pln"><br>&nbsp; </span><span class="pun">},</span><span class="pln"><br>&nbsp; </span><span class="pun">...</span><span class="pln"><br></span><span class="pun">};</span><span class="pln"><br><br></span><span class="kwd">function</span><span class="pln"> setupOfficeMarkers</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">var</span><span class="pln"> mgr </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MarkerManager</span><span class="pun">(</span><span class="pln">map</span><span class="pun">);</span><span class="pln"><br>&nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> officeLayer</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> layer </span><span class="pun">=</span><span class="pln"> officeLayer</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> markers </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[];</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> j </span><span class="kwd">in</span><span class="pln"> layer</span><span class="pun">[</span><span class="str">"places"</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> place </span><span class="pun">=</span><span class="pln"> layer</span><span class="pun">[</span><span class="str">"places"</span><span class="pun">][</span><span class="pln">j</span><span class="pun">];</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> icon </span><span class="pun">=</span><span class="pln"> getIcon</span><span class="pun">(</span><span class="pln">place</span><span class="pun">[</span><span class="str">"icon"</span><span class="pun">]);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">var</span><span class="pln"> posn </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">GLatLng</span><span class="pun">(</span><span class="pln">place</span><span class="pun">[</span><span class="str">"posn"</span><span class="pun">][</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> place</span><span class="pun">[</span><span class="str">"posn"</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; markers</span><span class="pun">.</span><span class="pln">push</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">GMarker</span><span class="pun">(</span><span class="pln">posn</span><span class="pun">,</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> title</span><span class="pun">:</span><span class="pln"> place</span><span class="pun">[</span><span class="str">"name"</span><span class="pun">],</span><span class="pln"> icon</span><span class="pun">:</span><span class="pln"> icon </span><span class="pun">}));</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; mgr</span><span class="pun">.</span><span class="pln">addMarkers</span><span class="pun">(</span><span class="pln">markers</span><span class="pun">,</span><span class="pln"> layer</span><span class="pun">[</span><span class="str">"zoom"</span><span class="pun">][</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> layer</span><span class="pun">[</span><span class="str">"zoom"</span><span class="pun">][</span><span class="lit">1</span><span class="pun">]);</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; mgr</span><span class="pun">.</span><span class="pln">refresh</span><span class="pun">();</span><span class="pln"><br></span><span class="pun">}</span></pre>

<p><a href="google_northamerica_offices.html">View example (google_northamerica_offices.html)</a>


</body>
</html>
